function GetQueryString(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),i=window.location.search.substr(1).match(t);return null!=i?unescape(i[2]):null}function setCookie(e,t){var i=new Date;i.setTime(i.getTime()+31536e7),document.cookie=e+"="+escape(t)+";expires="+i.toGMTString()+";path=/"}var listStopData="",type=0;function selectData(){if(""!=listStopData&&listStopData){var e=$("#stopCheck").val();e=e.toUpperCase(),$(".contnt_div").html("");var t,i="",a=listStopData.length;if(a>0){for(t=0;t<a;t++)if(""==e)i+=" <div class='line_record' id='"+t+"'>",i+="<img src='../img/line@3x.png' alt=''>",i+=1==type?" <span>"+listStopData[t].routeName+"</span>":" <span>"+listStopData[t].lineName+"</span>",i+=" </div>";else{var n="";(n=1==type?listStopData[t].routeName:listStopData[t].lineName).indexOf(e)>-1&&(i+=" <div class='line_record' id='"+t+"'>",i+="<img src='../img/line@3x.png' alt=''>",i+=" <span>"+n+"</span>",i+=" </div>")}$(".contnt_div").html(i),$(".contnt_div div").click(function(){var e=$(this).attr("id");e=parseInt(e);var t=localStorage.carStop;null==t&&(t={},t=JSON.stringify(t)),t=JSON.parse(t),1==type?(t[""+encodeURI(listStopData[e].routeName)]=encodeURI(listStopData[e].routeName),location.href=encodeURI("/views/actual_car.html?routeName="+encodeURI(listStopData[e].routeName))):(t[""+encodeURI(listStopData[e].routeName)]=encodeURI(listStopData[e].routeName),location.href=encodeURI("/views/actual_car.html?routeName="+encodeURI(listStopData[e].lineName))),localStorage.carStop=JSON.stringify(t)})}}}$(function(){var e,t=GetQueryString("line"),i=GetQueryString("stopId");if(null!=t||null!=i){window.yl.call("showLoading",{content:"正在加载中…",duration:15e3});var a="",n={};t?(type=1,t=t.toString().toUpperCase(),a=CONFIG.getLineInfoAndCardInfo+"realtimebus/query/queryService/getRouteCodeByLineName",n.p0=t):(type=2,a=CONFIG.getLineInfoAndCardInfo+"realtimebus/query/queryService/getLineSet",n.p0=i),$.post(a,n,function(i){window.yl.call("hideLoading"),i=JSON.parse(i),e=t?i.lines:i.lineSet,listStopData=e;var a,n="",o=e.length;if(o>0){for(n+="<div class='head_div'>",n+="<div class='next_head'>",n+="<img src='../img/screen@3x.png' alt=''>",n+="<input required='required' placeholder='请输入关键字' id='stopCheck' oninput='selectData()' />",n+="</div>",n+="<div class='line_head_div'>",n+="线路",n+="</div>",n+="</div>",n+=" <div class='contnt_div'>",a=0;a<o;a++)n+=" <div class='line_record' id='"+a+"'>",n+="<img src='../img/line@3x.png' alt=''>",n+=1==type?" <span>"+e[a].routeName+"</span>":" <span>"+e[a].lineName+"</span>",n+=" </div>";n+=" </div>",$(".main_div").html(n),$(".contnt_div div").click(function(){var t=$(this).attr("id");t=parseInt(t);var i=localStorage.carStop;null==i&&(i={},i=JSON.stringify(i)),i=JSON.parse(i),1==type?(i[""+encodeURI(e[t].routeName)]=encodeURI(e[t].routeName),location.href=encodeURI("/views/actual_car.html?routeName="+encodeURI(e[t].routeName))):(i[""+encodeURI(e[t].lineName)]=encodeURI(e[t].lineName),location.href=encodeURI("/views/actual_car.html?routeName="+encodeURI(e[t].lineName))),localStorage.carStop=JSON.stringify(i)})}else listStopData="",n+="<div class='head_div'>",n+="<div class='check_div'>",n+="<div class='line_input'>",n+="<div class='line_img'><img src='../img/search.png' alt='' /></div>",n+="    <input required='required' placeholder='请输入关键字' oninput='checkBtn()' id='line' />",n+=" </div>",n+="<button id='check_line' disabled='disabled'>查询</button>",n+="</div>",n+=" <div class='line_head_div'>",n+="  线路",n+=" </div>",n+=" </div>",n+="<div class='noRecord'>",n+="    <img src='../img/noRecord.png' alt=''>",n+="    <p>没有找到相关线路</p>",n+="</div>",$(".main_div").html(n)})}});