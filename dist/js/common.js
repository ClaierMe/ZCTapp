window.ENV="production",console.log("system enviroment: ",window.ENV),"dev"===window.ENV||"test"===window.ENV?window.CONFIG={loginByZst:"http://113.106.3.65:8052/",site:"http://a.zhongshantong.net/",getLineInfoAndCardInfo:"http://113.106.3.65:4180/",payRediectUrl:"http://sit-zhongshan.allcitygo.com/views/balance_data.html"}:window.CONFIG={loginByZst:"http://a.zhongshantong.net/",site:"http://a.zhongshantong.net/",getLineInfoAndCardInfo:"http://113.106.3.65:4180/",payRediectUrl:"http://a.zhongshantong.net:8888/views/balance_bind.html"},function(){var t=window.yl.getSystemInfo();console.log(t),window.sysInfo=t}();var zct={getLocation:function(t){window.yl.call("getLocation",{},{onSuccess:function(n){localStorage.location=JSON.stringify(n.param),t&&t(n.param)},onFail:function(t){console.log(JSON.stringify(t))}})},closeWebview:function(){window.yl.call("closeWebview")},setTitleBarRightButton:function(t,n){t=$.extend(!0,{title:"关闭"},t),window.yl.call("setTitleBarRightButton",{rightButtonShow:!0,rightButtonTextOpen:!1,rightButtonText:t.title,rightButtonIcon:"icon-user",itemList:[]},{onSuccess:function(t){n()},onFail:function(t){console.log("fail")}})},getAuthcode:function(t){window.yl.call("getAuthcode",{},{onSuccess:function(n){"dev"===window.ENV&&alert(n.param.authCode),localStorage.authCode=n.param.authCode,t&&t(localStorage.authCode)},onFail:function(t){console.log(t)}})},confirmAlert:function(t,n,o){var e='<div class="modal"><div class="mask"></div><div class="modal-content"><div class="modal-header"><p>'+(t=$.extend(!0,{title:"温馨提示",content:"",leftButtonText:"取消",rightButtonText:"确定"},t)).title+'</p></div><div class="modal-contenter"><p>'+t.content+'</p></div><div class="modal-footer"><button id="left-btn">'+t.leftButtonText+'</button><button id="right-btn">'+t.rightButtonText+"</button></div></div></div>";$(".modal").remove(),$("body").append(e),$("#left-btn").on("click",function(){$(".modal").hide(),o&&o()}),$("#right-btn").on("click",function(){$(".modal").hide(),n&&n()})},hideLoading:function(){window.yl.call("hideLoading")},showLoading:function(t){t=$.extend(!0,{title:"加载中...",duration:3e3},t),window.yl.call("showLoading",{content:t.title,duration:t.duration},{onSuccess:function(t){console.log("success")}})},alert:function(t){window.yl.call("alert",{title:t.title||"温馨提示",content:t.content||"",buttonText:t.buttonText||"确定"})},setTitleBarText:function(t){window.yl.call("setTitleBarText",{title:t.title||"众城通",titleColor:t.titleColor||"#F00FFFF",backgroundColor:t.backgroundColor||"#F00FF00"},{onSuccess:function(t){},onFail:function(t){console.log("fail")}})}};function distanceCaculate(t){var n=[t.lat0,t.lat],o=[t.lng0,t.lng],e=(n[1]-n[0])*Math.PI/180,a=(o[1]-o[0])*Math.PI/180,i=Math.sin(e/2)*Math.sin(e/2)+Math.cos(n[0]*Math.PI/180)*Math.cos(n[1]*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2),l=6378137*(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)));return Math.round(l)}function getNeighStation(t){var n=6378137;""!==t.dis&&"不限"!==t.dis&&void 0!==t.dis||(t.dis=2e3);var o=2*Math.asin(Math.sin(t.dis/(2*n))/Math.cos(t.lat*Math.PI/180));o=180*o/Math.PI;var e=t.dis/n;return e=180*e/Math.PI,{minlat:t.lat-e.toFixed(6),maxlat:+e.toFixed(6)+t.lat,minlng:t.lng-o.toFixed(6),maxlng:+o.toFixed(6)+t.lng}}function toMap(t){zct.showLoading({content:"地图加载中"}),t=$.extend(!0,{scale:18,longitude:"",latitude:"",markType:"zsbike",marks:[]},t),window.yl.call("map",{longitude:t.longitude.toString(),latitude:t.latitude.toString(),scale:t.scale,markType:t.markType,marks:t.marks},{onSuccess:function(t){setTimeout(function(){zct.hideLoading()},600)},onFail:function(t){console.log(t)}})}var common={isBandCrad:function(){if(localStorage.isBandCard)return!0;location.href="/views/balance_bind.html"},getToken:function(t){request({url:"appTradeService/getToken",type:"GET"},function(n){"dev"===window.ENV&&alert(n.token);var o=n.token;window.token=o,t&&t(o)})},getCachUserInfo:function(t){localStorage.userInfo?t&&t(JSON.parse(localStorage.userInfo)):zct.getAuthcode(function(n){request({host:CONFIG.loginByZst,url:"ZST/orienteering/loginByZst?authCode="+n+"&systemId="+window.sysInfo.systemId,type:"GET"},function(n){"dev"===window.ENV&&alert(JSON.stringify(n)),localStorage.userInfo=JSON.stringify(n),t&&t(n)})})},getUerInfo:function(t){zct.getAuthcode(function(n){request({host:CONFIG.loginByZst,url:"ZST/orienteering/loginByZst?authCode="+n+"&systemId="+window.sysInfo.systemId,type:"GET"},function(n){"dev"===window.ENV&&alert(JSON.stringify(n)),localStorage.userInfo=JSON.stringify(n),t&&t(data)})})}};function request(t,n){var o=$.extend(!0,{host:"https://a.zhongshantong.net:8443/app/d/app/",url:"",type:"GET",dataType:"json",data:{},headers:{"Content-type":"application/json;charset=utf-8",Cookie:"JSESSIONID="+(localStorage.JSESSIONID||"")},timeout:1e4},t);o.method=o.type,o.url=o.host+o.url,window.yl.call("httpRequest",o,{onSuccess:function(t){for(var o="",e=0;e<t.param.headers.length;e++)if(t.param.headers[e]["Set-Cookie"]){var a=(o=t.param.headers[e]["Set-Cookie"]).indexOf(";"),i=o.indexOf("=")+1;o=o.substring(i,a),localStorage.JSESSIONID=o;break}"dev"===window.ENV&&alert(t.param.data);var l=JSON.parse(t.param.data);n(l)},onFail:function(t){zct.hideLoading(),console.log(JSON.stringify(t)),window.yl.call("showToast",{duration:3e3,content:"网络异常，请查看网络连接"})}})}function ajax(t,n){var o=$.extend({host:"",url:"",method:"GET",dataType:"json",crossDomain:!0,processData:!1,timeout:8e3,contentType:"application/json;charset=utf-8",success:function(t){"dev"===window.ENV&&alert(t),console.log(t),n&&n.call(null,t)},error:function(t){console.log(t),window.yl.call("showToast",{duration:3e3,content:"网络异常，请查看网络连接"})}},t);o.url=o.host+o.url,console.log(o),$.ajax(o)}function parseQueryString(t){var n={},o=[],e="",a="",i=t.substring(t.indexOf("?")+1,t.length).split("&");for(var l in i)e=(o=i[l].split("="))[0],a=o[1],n[e]=a;return n}function createURL(t){var n="";$.each(t,function(t,o){n+="&"+t+"="+o});var o="?"+n.substr(1);return $.trim(o),o}$.fn.extend({animateCss:function(t,n){var o=function(t){var n={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var o in n)if(void 0!==t.style[o])return n[o]}(document.createElement("div"));return this.addClass("animated "+t).one(o,function(){$(this).removeClass("animated "+t),"function"==typeof n&&n()}),this}});var cookie={set:function(t,n,o=365){var e=o||365,a=new Date;a.setTime(a.getTime()+24*e*60*60*1e3),document.cookie=t+"="+escape(n)+";expires="+a.toGMTString()+";path=/"},get:function(t){var n=new RegExp("(^| )"+t+"=([^;]*)(;|$)"),o=n;return(n=document.cookie.match(o))?unescape(n[2]):null},delete:function(t){var n=new Date;n.setTime(n.getTime()-1);var o=this.get(t);null!=o&&(document.cookie=t+"="+o+";expires="+n.toGMTString()+";path=/")}},cache={getItem:function(t){var n=localStorage.getItem(t);return!!n&&(n=JSON.parse(n))},setItem:function(t,n){localStorage.setItem(t,n),console.log("set localStorage key: "+t+", value: "+n)},deelete:function(t){localStorage.removeItem(t)},clearAll:function(){localStorage.clear(),console.log("localStorage is cleared")}};